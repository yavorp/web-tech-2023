# Асинхронност

## What is JS?
JS се изпълнява от JS runtime, за ноуд и хроум това е V8     
V8 е съставен heap и stack
- heap - тук се случва memory allocation
- stack - stackframe на програмата. С 2 думи callstack-a е мястото, в което се следи до къде е стигнала програмата
// Показвам пример



## States of the processor
Процесорът е машината, която прави изчисления в компютърът.
Примерите, които разгледахме имат едно общо свойство. Те държат процесора зает докато не приключи програмата.
Ако трябва да сме по-коректни, те държат едно от процесорните ядра заето докато програмата не приключи.
Програмите, особено уеб приложенията, не се нуждаят само от изчисления. Понякога програмата, за да работи коректно, трябва да получи ресурс от интернет, понякога трябва да се прочете файл.       
Всяка програма в хода на нейното изпълнение се нарича процес. Той се харектеризира със собствен стек и място, в паметта, до което има достъп. За по-пълна дефиниция може да видите [Wikipedia](https://en.wikipedia.org/wiki/Process_(computing))      
Тези операции са бавни, защото се достъпват ресурси, които са външни за процеса. Би било загуба на процесорна мощ, ако процесорът продължи да цилки, докато се чака някакъв външен за процеса ресурс, да бъде достъпен в самия процес.       

За да не губим време процесорно време, се появяват `async callbacks`. API-те, с които работи ноде.     
Знаем, че JS е еднонишков език и, че JS runtime може да прави само едно нещо. Но node JS е повече от V8. В node има различни API, чрез които можем да достъпваме файловата система, да слушаме за сокети, да правим. Реално V8 си комуникиа с тези API-та. Тези апита зад сцената използват C++. Но всичко това остава скрито за потребителя.
Освен тези АПИ-та, съществува и нещо, което се нарича event loop. C++ API-те записват резултата си
След това се викат callback-а с резултата, който е сметнат от апи-то, което сме използвали.   
CBs се записват в една опашка. Тази опашка се нарича Task Queue. А event loop-a ни помага да менажираме тази опашка.
Реално след като даден cb стигне до опашката. Той се пушва в стека на програмата и се изпълнява.
Програмата спира работа, когато в event loop-a няма повече задачи както и task queue-то.


https://imelgrat.me/javascript/node-js-inside-out/

Event Loop-a 